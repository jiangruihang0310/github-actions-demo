<!DOCTYPE html>
<html style="height: 100%">

<head>
	<meta charset="utf-8">
</head>

<body style="height: 100% ;width:80%; margin: auto;background:#011943">
	<div id="container" style="height: 200px"></div>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@4/dist/echarts.min.js"></script>
	<script type="text/javascript">

		var dom = document.getElementById("container");
		var myChart = echarts.init(dom);
		var app = {};


		var colors = ['#21DE73', '#4D7BBD', '#ccc']; //三种状态的颜色
		var state = ['运行', '停机', '无信号']; //三种状态
		var abc = ''
		const xAxisData = [
			"2023-08-24 00:00:00",
			"2023-08-24 00:01:00",
			"2023-08-24 00:02:00",
			"2023-08-24 00:03:00",
		]
		const data = [
			"0",
			"0",
			"0",
			"0",
		]
		const datas = data.map((item, index) => {
			return {
				name: "设备运行状态",
				itemStyle: {
					color: item == '0' ? new echarts.graphic.LinearGradient(0, 0, 0, 1, [
						{
							offset: 0,
							color: 'rgb(0, 0, 255)'
						},
						{
							offset: 1,
							color: 'rgb(65, 105, 225)'
						}
					]) : item == '1' ? new echarts.graphic.LinearGradient(0, 0, 0, 1, [
						{
							offset: 0,
							color: 'rgb(34, 139, 34)'
						},
						{
							offset: 1,
							color: 'rgb(0, 250, 154)'
						}
					]) : new echarts.graphic.LinearGradient(0, 0, 0, 1, [
						{
							offset: 0,
							color: 'rgb(169, 169, 169)'
						},
						{
							offset: 1,
							color: 'rgb(128, 128, 128)'
						}
					])
				}, value: [Number(item), xAxisData[index], xAxisData[index + 2]]
			}
		})
		// echart配置
		var option = {
			title: {
				// text: '当前设备运行状态表',
				left: 'left',
				// top: '%',
				left: '10%'
			},
			color: colors,
			tooltip: {//提示框
				formatter: function (params) {
					const str = params.value[0] == '0' ? "停机" : params.value[0] == '1' ?
						'启动' : "无信号"
					return params.name + '：<br/>' + params.value[1] + '&ensp;' + str;
				}//数据的值
			},
			legend: {//图例
				data: ['运行', '停机', '无信号'],
				top: '5%',
				selectedMode: false, // 图例设为不可点击
				textStyle: {
					color: '#000'
				},
				textStyle: {
					color: '#fff'
				}
			},
			grid: {//绘图网格
				left: '10%',
				right: '5%',
				top: '20%',
				bottom: '20%',
				borderWidth: 0
			},
			xAxis: {
				type: 'category',
				scale: true,
				axisLine: {
					lineStyle: {
						show: false,
						color: '#fff'
					}
				},
				axisLabel: {
					// align: 'left', // 将刻度标签居中对齐
					verticalAlign: 'middle' // 垂直居中对齐
				},
				axisTick: {
					show: false,
				},
				splitLine: {
					show: false
				},
				data: xAxisData
			},
			yAxis: {
				name: '启停信号',
				type: 'value',
				max: 1,
				min: 0,
				minInterval: 1,
				axisLine: {
					show: false,
					lineStyle: {
						show: false,
						color: '#fff',
					}
				},
				axisLabel: {
					show: false,
					// align: 'left', // 将刻度标签居中对齐
					verticalAlign: 'middle' // 垂直居中对齐
				},
				axisTick: {
					show: false,
				},
				splitLine: {
					show: false
				},
				// data: ['启停信号'],
			},
			series: [

				{ name: '运行', type: 'bar', data: [] },
				{ name: '停机', type: 'bar', data: [] },// 用空bar来显示三个图例
				{ name: '无信号', type: 'bar', data: [] },// 用空bar来显示三个图例
				{
					type: 'custom',
					borderWidth: 0,
					labelLayout: () => {
						return { verticalAlign: 'middle' }
					},
					renderItem: function (params, api) {//开发者自定义的图形元素渲染逻辑，是通过书写 renderItem 函数实现的
						var categoryIndex = api.value(0);//这里使用 api.value(0) 取出当前 dataItem 中第一个维度的数值。
						var start = api.coord([api.value(1), categoryIndex]); // 这里使用 api.coord(...) 将数值在当前坐标系中转换成为屏幕上的点的像素值。
						var end = api.coord([api.value(2), categoryIndex]);
						var height = api.size([0, 1])[1] * 5;
						var containerHeight = api.getHeight(); // 获取容器高度
						var customHeight = 30; // 自定义图形的固定高度
						var yOffset = (containerHeight - customHeight) / 4
						console.log(params, '2222');
						return {
							type: 'rect',// 表示这个图形元素是矩形。还可以是 'circle', 'sector', 'polygon' 等等。

							align: 'center',
							shape: echarts.graphic.clipRectByRect({ // 矩形的位置和大小。
								x: start[0],
								y: start[1] - height / 2,
								width: end[0] - start[0],
								height: height
							}, { // 当前坐标系的包围盒。
								x: params.coordSys.x,
								y: params.coordSys.y + yOffset,
								width: params.coordSys.width,
								height: customHeight,
							}),
							style: api.style(),

						};
					},
					encode: {
						x: [1, 2], // data 中『维度1』和『维度2』对应到 X 轴
						y: 0,	// data 中『维度0』对应到 Y 轴

					},
					data: datas
				}
			]
		};
		console.log(datas);


		if (option && typeof option === "object") {
			myChart.setOption(option, true);
		}
	</script>
</body>

</html>